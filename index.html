<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pi Bot</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #status { font-weight: bold; font-size: 1.2em; margin-top: 10px; }
    #countdown { font-size: 1.5em; color: #008000; }
  </style>
</head>
<body>
  <h2>Pi Bot</h2>
  <p><strong>Unlock Time:</strong> <span id="target-time"></span></p>
  <p><strong>Countdown:</strong> <span id="countdown"></span></p>
  <p id="status">Authenticating...</p>

  <script>
    const bitgetAddress = "Mxxxxxxxxxxxxxxxxxxxxx"; // REPLACE with real Bitget deposit address
    const piAmount = "10"; // Amount to send
    const unlockTime = new Date("2025-04-20T19:13:00Z").getTime(); // UTC unlock time

    document.getElementById("target-time").innerText = new Date(unlockTime).toLocaleString();

    window.Pi.init({ version: "2.0", sandbox: false });

    window.Pi.authenticate(["username", "payments"], onAuthSuccess, onAuthFailure);

    function onAuthSuccess(auth) {
      document.getElementById("status").innerText = "Authenticated. Monitoring unlock time...";
      const interval = setInterval(() => {
        const now = Date.now();
        const diff = unlockTime - now;

        if (diff <= 0) {
          clearInterval(interval);
          document.getElementById("countdown").innerText = `0h 0m 0s`;
          sendPi();
        } else {
          const hrs = Math.floor(diff / 3600000);
          const mins = Math.floor((diff % 3600000) / 60000);
          const secs = Math.floor((diff % 60000) / 1000);
          document.getElementById("countdown").innerText = `${hrs}h ${mins}m ${secs}s`;
        }
      }, 500);
    }

    function onAuthFailure(error) {
      document.getElementById("status").innerText = "Auth failed: " + error;
    }

    function sendPi() {
      document.getElementById("status").innerText = "Unlock reached! Sending Pi...";
      window.Pi.createPayment({
        amount: piAmount,
        memo: "Auto send to Bitget",
        to: bitgetAddress
      }).then((payment) => {
        document.getElementById("status").innerText = "Payment Sent! Tx ID: " + payment.identifier;
      }).catch((err) => {
        document.getElementById("status").innerText = "Payment failed: " + err.message;
      });
    }
  </script>
</body>
</html>
